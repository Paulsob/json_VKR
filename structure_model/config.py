from pathlib import Path

# =============================================================================
# БАЗОВЫЕ ПУТИ ПРОЕКТА
# =============================================================================

# Базовый каталог проекта — один источник правды
BASE_DIR = Path(__file__).resolve().parent.parent

# Excel-файл с шаблонами расписаний
FILE_PATH = BASE_DIR / "data" / "data.xlsx"

# Директории
HISTORY_JSON_DIR = BASE_DIR / "history_json"
OUTPUT_DIR_TRAM = BASE_DIR / "output"        # трамваи
OUTPUT_DIR_OBUS = BASE_DIR / "output_obus"   # троллейбусы

# Создаём каталоги
HISTORY_JSON_DIR.mkdir(parents=True, exist_ok=True)
OUTPUT_DIR_TRAM.mkdir(parents=True, exist_ok=True)
OUTPUT_DIR_OBUS.mkdir(parents=True, exist_ok=True)

# =============================================================================
# ПАРАМЕТРЫ EXCEL
# =============================================================================

ROW_START = 5
STEP = 2

COL_SHIFT_1_INSERT = 3
COL_SHIFT_2_INSERT = 8

COL_SHIFT_1_START = 5
COL_SHIFT_1_END = 6
COL_SHIFT_2_START = 10
COL_SHIFT_2_END = 11

TAB_SHEET_NAME = "Весь_табель"

# Код выходного дня в табеле
WEEKEND_CODE = "В"

# =============================================================================
# ОБЩИЕ ПАРАМЕТРЫ ПЛАНИРОВЩИКА
# =============================================================================

TOTAL_DAYS_IN_MONTH = 30
REST_HOURS = 12.0

# Разрешать ли вызывать водителей в выходной
ALLOW_WEEKEND_EXTRA_WORK = False

# Файл реальных отсутствий
ABSENCES_FILE = str(BASE_DIR / "real_absences.json")

# =============================================================================
# КОНФИГУРАЦИЯ ТРАНСПОРТА
# =============================================================================
# Ключевая идея:
# - никаких диапазонов "на глаз"
# - маршруты задаются ЯВНО
# - поддерживаются строковые номера (например "93тб")
# =============================================================================

TRANSPORTS = {
    # -------------------------------------------------------------------------
    # ТРАМВАИ
    # -------------------------------------------------------------------------
    "tram": {
        "output_dir": OUTPUT_DIR_TRAM,

        # ⚠️ ВАЖНО:
        # здесь укажи РЕАЛЬНЫЕ трамвайные маршруты
        "routes": {
            "workday": [
                "9", "20", "21", "47", "48", "55", "61"
            ],
            "weekend": [
                "9", "20", "21", "47", "48", "55", "61"
            ],
        },

        # Карта Excel-листов
        "sheets": {
            ("9", True): "Расписание_выходного_дня_9",
            ("9", False): "Расписание_рабочего_дня_9",

            ("20", True): "Расписание_выходного_дня_20",
            ("20", False): "Расписание_рабочего_дня_20",

            ("21", True): "Расписание_выходного_дня_21",
            ("21", False): "Расписание_рабочего_дня_21",

            ("47", True): "Расписание_выходного_дня_47",
            ("47", False): "Расписание_выходного_дня_47",

            ("48", True): "Расписание_выходного_дня_48",
            ("48", False): "Расписание_выходного_дня_48",

            ("55", True): "Расписание_выходного_дня_55",
            ("55", False): "Расписание_рабочего_дня_55",

            ("61", True): "Расписание_выходного_дня_61",
            ("61", False): "Расписание_рабочего_дня_61",
        },
    },

    # -------------------------------------------------------------------------
    # ТРОЛЛЕЙБУСЫ (obus)
    # -------------------------------------------------------------------------
    "obus": {
        "output_dir": OUTPUT_DIR_OBUS,

        # ЯВНЫЕ СПИСКИ МАРШРУТОВ
        "routes": {
            "workday": [
                "1", "3", "5", "9", "12", "15",
                "16", "18", "21", "22", "33",
                "43", "93тб"
            ],
            "weekend": [
                "1", "3", "5", "8", "9", "10",
                "12", "15", "16", "18", "22",
                "33", "38", "43", "93тб"
            ],
        },

        # Карта Excel-листов
        "sheets": {
            ("1", True): "Расписание_выходного_дня_1",
            ("1", False): "Расписание_рабочего_дня_1",

            ("3", True): "Расписание_выходного_дня_3",
            ("3", False): "Расписание_рабочего_дня_3",

            ("5", True): "Расписание_выходного_дня_5",
            ("5", False): "Расписание_рабочего_дня_5",

            ("8", True): "Расписание_выходного_дня_8",

            ("9", True): "Расписание_выходного_дня_9",
            ("9", False): "Расписание_рабочего_дня_9",

            ("10", True): "Расписание_выходного_дня_10",

            ("12", True): "Расписание_выходного_дня_12",
            ("12", False): "Расписание_рабочего_дня_12",

            ("15", True): "Расписание_выходного_дня_15",
            ("15", False): "Расписание_рабочего_дня_15",

            ("16", True): "Расписание_выходного_дня_16",
            ("16", False): "Расписание_рабочего_дня_16",

            ("18", True): "Расписание_выходного_дня_18",
            ("18", False): "Расписание_выходного_дня_18",

            ("21", False): "Расписание_рабочего_дня_21",

            ("22", True): "Расписание_выходного_дня_22",
            ("22", False): "Расписание_рабочего_дня_22",

            ("33", True): "Расписание_выходного_дня_33",
            ("33", False): "Расписание_рабочего_дня_33",

            ("38", True): "Расписание_выходного_дня_38",

            ("43", True): "Расписание_выходного_дня_43",
            ("43", False): "Расписание_рабочего_дня_43",

            ("93тб", True): "Расписание_выходного_дня_93тб",
            ("93тб", False): "Расписание_выходного_дня_93тб",
        },
    },
}
